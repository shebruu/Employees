{% extends 'base.html.twig' %}

{% block title %}Mes Missions{% endblock %}

{% block body %}
<div class="container py-4">
	<h2 class="mb-4">Mes Missions Actives <span class="fs-6 text-muted">(non terminées)</span></h2>

	<form action="{{ path('app_mission_update',{'id': app.user.id}) }}" method="post">
		<div class="row g-3">
			{% for mission in missionsActives %}
				<div class="col-md-6 col-lg-4">
					<div class="card shadow-sm h-100">
						<div class="card-body d-flex flex-column justify-content-between">
							<h5 class="card-title">{{ mission.description }}</h5>
							<p class="card-text"><span class="badge bg-info text-dark">{{ mission.status.value }}</span></p>
							<input type="hidden" name="missionId" value="{{ mission.id }}">
							<input type="hidden" name="action" value="terminer">
							<button name="btterminer" type="submit" class="btn btn-success fw-bold mt-2" value="{{ mission.id }}">
								Terminer
							</button>
						</div>
					</div>
				</div>
			{% else %}
				<div class="col-12">
					<div class="alert alert-secondary">Aucune mission active.</div>
				</div>
			{% endfor %}
		</div>

		<h2 class="mt-5 mb-4">Missions Non Assignées</h2>
		<div class="row g-3">
			{% for mission in missionsNonAssignees %}
				<div class="col-md-6 col-lg-4">
					<div class="card shadow-sm h-100">
						<div class="card-body d-flex flex-column justify-content-between">
							<h5 class="card-title">{{ mission.description }}</h5>
							<p class="card-text"><span class="badge bg-warning text-dark">{{ mission.status.value }}</span></p>
							<input type="hidden" name="missionId" value="{{ mission.id }}">
							{% if mission.status.value == 'en attente' %}
								<input type="hidden" name="action" value="accepter">
								<button name="btaccepter" type="submit" class="btn btn-primary fw-bold mt-2" value="{{ mission.id }}">
									Accepter
								</button>
							{% elseif mission.status.value == 'en cours' %}
								<input type="hidden" name="action" value="rejoindre">
								<button name="btrejoindre" type="submit" class="btn btn-warning fw-bold mt-2" value="{{ mission.id }}">
									Rejoindre
								</button>
							{% endif %}
						</div>
					</div>
				</div>
			{% else %}
				<div class="col-12">
					<div class="alert alert-secondary">Aucune mission non assignée.</div>
				</div>
			{% endfor %}
		</div>
	</form>
</div>
{% endblock %}
